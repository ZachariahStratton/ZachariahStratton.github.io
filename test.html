<html>
        <head>
        <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
        <script src="jquery-2.1.4.js"></script>
        <link rel="stylesheet" type="text/css" href="styles.css">
        </head>
        <body>
		
        <div id="navbar"><span>3D Sock Design Viewer</span></div>
        <script src="./three.min.js"></script>
        <script src="./OBJLoader.js"></script>
		
		<!-- Source: https://jsfiddle.net/f2Lommf5/4991/ -->
		<script type='text/javascript'>
		let camera, scene, renderer, mesh;

		init();
		animate();
			
		function init() {
		
			//Upload texture button
			var inputFileToLoad = document.createElement("input");
			inputFileToLoad.type = "file";
			inputFileToLoad.id = "inputFileToLoad";
			document.body.appendChild(inputFileToLoad);

			var buttonLoadFile = document.createElement("button");
			buttonLoadFile.onclick = applyTexture;
			buttonLoadFile.textContent = "Apply Texture";
			document.body.appendChild(buttonLoadFile);

			//create scene for 3D model
		    camera = new THREE.PerspectiveCamera(70, window.innerWidth / window.innerHeight, 0.01, 10);
		    camera.position.z = 1;
		    scene = new THREE.Scene();
			
			//Load default textures
			var tLoader = new THREE.TextureLoader();
			var texture1 = tLoader.load('img.jpg');
			
			//var material = new THREE.MeshPhongMaterial({map: map});
			
			//Create 3D model from obj file
			//instantiate a loader
			var oLoader = new THREE.OBJLoader();

			// load a resource
			oLoader.load('model.obj', function ( object ) {
					object.traverse( function ( node ) {
						if ( node.isMesh ) node.material = material;
					} );
					scene.add( object );
			} );
			
			/*
		    const geometry = new THREE.BoxBufferGeometry(0.4, 0.4, 0.4);
			const material = new THREE.MeshBasicMaterial({
				map: texture1
			});

		    mesh = new THREE.Mesh(geometry, material);
		    scene.add(mesh);
			*/

			
		    renderer = new THREE.WebGLRenderer({
			  antialias: true
		    });
		    renderer.setPixelRatio(window.devicePixelRatio);
		    renderer.setSize(window.innerWidth, window.innerHeight);
		    document.body.appendChild(renderer.domElement);

			/*
		    setTimeout(() => {

			material.map = texture2;
			texture1.dispose();

			}, 3000); // change the texture after three seconds
			*/
			
			function applyTexture()
			{
				var filesSelected = document.getElementById("inputFileToLoad").files;
				if (filesSelected.length > 0)
				{
					var fileToLoad = filesSelected[0];

					if (fileToLoad.type.match("image.*"))
					{
						var fileReader = new FileReader();
						fileReader.onload = function(fileLoadedEvent) 
						{
							const loader2 = new THREE.TextureLoader();
							newTexture = loader2.load(fileLoadedEvent.target.result);
							material.map = newTexture;
						};
						fileReader.readAsDataURL(fileToLoad);
					}
				}
			}
		}

		function animate() {

		  requestAnimationFrame(animate);

		  mesh.rotation.x += 0.01;
		  mesh.rotation.y += 0.02;

		  renderer.render(scene, camera);

		}

		main();
		</script>
		
        </body>
</html>